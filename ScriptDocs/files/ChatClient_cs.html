<!DOCTYPE html><html><head><meta charset='UTF-8'><title>ChatClient.cs - 詳細</title><link rel='stylesheet' href='../styles.css'></head><body><div class='container'><div class='nav-bar'><a href='../index.html'>&lt; トップページへ戻る</a> | <span>File: ChatClient.cs</span></div><div style='background:#666; color:white; padding:10px 15px; border-radius:5px; margin-bottom:20px;'>File Path: <span style='opacity:0.8'>Assets/Photon/PhotonChat/Code/ChatClient.cs</span></div><div id='ChatClient' style='border:1px solid #ccc; border-top:none; padding:20px; background:white; margin-bottom:40px; border-radius:5px;'><h3><span><span class='tag tag-cls'>Class</span> ChatClient <span style='color:#7f8c8d; font-weight:normal; font-size:0.9em;'>: IPhotonPeerListener</span></span><span style='font-size:0.8em; font-weight:normal; color:#666;'>Photon.Chat</span></h3><div class='desc-box'>Central class of the Photon Chat API to connect, handle channels and messages.<br/>Defines which IPhotonSocket class to use per ConnectionProtocol.</div><h4>フィールド (Variables)</h4><table><thead><tr><th>アクセス</th><th>名前</th><th>型</th><th>説明</th><th>属性・制約</th></tr></thead><tbody><tr><td class='center'><span class='acc acc-private'>private</span></td><td><span class='tag tag-static'>S</span><b>FriendRequestListMax</b></td><td class='center'><code>Int32</code></td><td></td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><span class='tag tag-static'>S</span><b>DefaultMaxSubscribers</b></td><td class='center'><code>Int32</code></td><td>Default maximum value possible for  when  is enabled</td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><span class='tag tag-static'>S</span><b>HttpForwardWebFlag</b></td><td class='center'><code>Byte</code></td><td></td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>chatRegion</b></td><td class='center'><code>String</code></td><td>Region used to connect to. Currently all chat is done in EU. It can make sense to use only one region for the whole game.</td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>ProxyServerAddress</b></td><td class='center'><code>String</code></td><td>Settable only before you connect! Defaults to &quot;EU&quot;.</td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>MessageLimit</b></td><td class='center'><code>Int32</code></td><td>If greater than 0, new channels will limit the number of messages they cache locally.</td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>PrivateChatHistoryLength</b></td><td class='center'><code>Int32</code></td><td>Limits the number of messages from private channel histories.</td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>PublicChannels</b></td><td class='center'><code>Dictionary`2</code></td><td>Public channels this client is subscribed to.</td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>PrivateChannels</b></td><td class='center'><code>Dictionary`2</code></td><td>Private channels in which this client has exchanged messages.</td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>PublicChannelsUnsubscribing</b></td><td class='center'><code>HashSet`1</code></td><td></td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>listener</b></td><td class='center'><code>IChatClientListener</code></td><td></td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>chatPeer</b></td><td class='center'><code>ChatPeer</code></td><td>The Chat Peer used by this client.</td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><span class='tag tag-static'>S</span><b>ChatAppName</b></td><td class='center'><code>String</code></td><td></td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>didAuthenticate</b></td><td class='center'><code>Boolean</code></td><td></td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>statusToSetWhenConnected</b></td><td class='center'><code>Nullable`1</code></td><td></td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>messageToSetWhenConnected</b></td><td class='center'><code>Object</code></td><td></td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>msDeltaForServiceCalls</b></td><td class='center'><code>Int32</code></td><td></td><td class='center'></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>msTimestampOfLastServiceCall</b></td><td class='center'><code>Int32</code></td><td></td><td class='center'></td></tr></tbody></table><h4>プロパティ (Properties)</h4><table><thead><tr><th>アクセス</th><th>名前</th><th>型</th><th>説明</th></tr></thead><tbody><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>EnableProtocolFallback</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>Boolean</code></td><td>Enables a fallback to another protocol in case a connect to the Name Server fails.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>NameServerAddress</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>String</code></td><td>The address of last connected Name Server.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>FrontendAddress</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>String</code></td><td>The address of the actual chat server assigned from NameServer. Public for read only.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>ChatRegion</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>String</code></td><td>Settable only before you connect! Defaults to &quot;EU&quot;.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>State</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>ChatState</code></td><td>Current state of the ChatClient. Also use CanChat.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>DisconnectedCause</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>ChatDisconnectCause</code></td><td>Disconnection cause. Check this inside .</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>CanChat</b> <span style='font-size:0.8em; color:#888'>{ get;  }</span></td><td class='center'><code>Boolean</code></td><td>Checks if this client is ready to send messages.</td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>HasPeer</b> <span style='font-size:0.8em; color:#888'>{ get;  }</span></td><td class='center'><code>Boolean</code></td><td></td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>AppVersion</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>String</code></td><td>The version of your client. A new version also creates a new &quot;virtual app&quot; to separate players from older client versions.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>AppId</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>String</code></td><td>The AppID as assigned from the Photon Cloud.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>AuthValues</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>AuthenticationValues</code></td><td>Settable only before you connect!</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>UserId</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>String</code></td><td>The unique ID of a user/person, stored in AuthValues.UserId. Set it before you connect.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>UseBackgroundWorkerForSending</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>Boolean</code></td><td>Defines if a background thread will call SendOutgoingCommands, while your code calls Service to dispatch received messages.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>TransportProtocol</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>ConnectionProtocol</code></td><td>Exposes the TransportProtocol of the used PhotonPeer. Settable while not connected.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>SocketImplementationConfig</b> <span style='font-size:0.8em; color:#888'>{ get;  }</span></td><td class='center'><code>Dictionary`2</code></td><td>Defines which IPhotonSocket class to use per ConnectionProtocol.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>DebugOut</b> <span style='font-size:0.8em; color:#888'>{ get; set; }</span></td><td class='center'><code>DebugLevel</code></td><td>Sets the level (and amount) of debug output provided by the library.</td></tr></tbody></table><h4>コンストラクタ (Constructors)</h4><table><thead><tr><th>アクセス</th><th>名前</th><th>引数</th><th>説明</th></tr></thead><tbody><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>ChatClient</b></td><td><small>IChatClientListener listener, ConnectionProtocol protocol</small></td><td>Constructor</td></tr></tbody></table><h4>メソッド (Methods)</h4><table><thead><tr><th>アクセス</th><th>名前</th><th>引数</th><th>戻り値</th><th>説明</th></tr></thead><tbody><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>CanChatInChannel</b></td><td><small>String channelName</small></td><td class='center'><code>Boolean</code></td><td>Checks if this client is ready to send messages.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>ConnectUsingSettings</b></td><td><small>ChatAppSettings appSettings</small></td><td class='center'><code>Boolean</code></td><td></td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>Connect</b></td><td><small>String appId, String appVersion, AuthenticationValues authValues</small></td><td class='center'><code>Boolean</code></td><td>Connects this client to the Photon Chat Cloud service, which will also authenticate the user (and set a UserId).</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>ConnectAndSetStatus</b></td><td><small>String appId, String appVersion, AuthenticationValues authValues, Int32 status, Object message</small></td><td class='center'><code>Boolean</code></td><td>Connects this client to the Photon Chat Cloud service, which will also authenticate the user (and set a UserId).
This also sets an online status once connected. By default it will set user status to .
See  for more information.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>Service</b></td><td><small></small></td><td class='center'><code>Void</code></td><td>Must be called regularly to keep connection between client and server alive and to process incoming messages.</td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>SendOutgoingInBackground</b></td><td><small></small></td><td class='center'><code>Boolean</code></td><td>Called by a separate thread, this sends outgoing commands of this peer, as long as it&#39;s connected.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>SendAcksOnly</b></td><td><small></small></td><td class='center'><code>Void</code></td><td>Obsolete: Better use UseBackgroundWorkerForSending and Service().</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>Disconnect</b></td><td><small>ChatDisconnectCause cause</small></td><td class='center'><code>Void</code></td><td>Disconnects from the Chat Server by sending a &quot;disconnect command&quot;, which prevents a timeout server-side.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>StopThread</b></td><td><small></small></td><td class='center'><code>Void</code></td><td>Locally shuts down the connection to the Chat Server. This resets states locally but the server will have to timeout this peer.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>Subscribe</b></td><td><small>String[] channels</small></td><td class='center'><code>Boolean</code></td><td>Sends operation to subscribe to a list of channels by name.
Sends operation to subscribe to a list of channels by name and possibly retrieve messages we did not receive while unsubscribed.
Sends operation to subscribe client to channels, optionally fetching a number of messages from the cache.
Subscribe to a single channel and optionally sets its well-know channel properties in case the channel is created.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>Subscribe</b></td><td><small>String[] channels, Int32[] lastMsgIds</small></td><td class='center'><code>Boolean</code></td><td>Sends operation to subscribe to a list of channels by name.
Sends operation to subscribe to a list of channels by name and possibly retrieve messages we did not receive while unsubscribed.
Sends operation to subscribe client to channels, optionally fetching a number of messages from the cache.
Subscribe to a single channel and optionally sets its well-know channel properties in case the channel is created.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>Subscribe</b></td><td><small>String[] channels, Int32 messagesFromHistory</small></td><td class='center'><code>Boolean</code></td><td>Sends operation to subscribe to a list of channels by name.
Sends operation to subscribe to a list of channels by name and possibly retrieve messages we did not receive while unsubscribed.
Sends operation to subscribe client to channels, optionally fetching a number of messages from the cache.
Subscribe to a single channel and optionally sets its well-know channel properties in case the channel is created.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>Unsubscribe</b></td><td><small>String[] channels</small></td><td class='center'><code>Boolean</code></td><td>Unsubscribes from a list of channels, which stops getting messages from those.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>PublishMessage</b></td><td><small>String channelName, Object message, Boolean forwardAsWebhook</small></td><td class='center'><code>Boolean</code></td><td>Sends a message to a public channel which this client subscribed to.</td></tr><tr><td class='center'><span class='acc acc-internal'>internal</span></td><td><b>PublishMessageUnreliable</b></td><td><small>String channelName, Object message, Boolean forwardAsWebhook</small></td><td class='center'><code>Boolean</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>publishMessage</b></td><td><small>String channelName, Object message, Boolean reliable, Boolean forwardAsWebhook</small></td><td class='center'><code>Boolean</code></td><td></td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>SendPrivateMessage</b></td><td><small>String target, Object message, Boolean forwardAsWebhook</small></td><td class='center'><code>Boolean</code></td><td>Sends a private message to a single target user. Calls OnPrivateMessage on the receiving client.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>SendPrivateMessage</b></td><td><small>String target, Object message, Boolean encrypt, Boolean forwardAsWebhook</small></td><td class='center'><code>Boolean</code></td><td>Sends a private message to a single target user. Calls OnPrivateMessage on the receiving client.</td></tr><tr><td class='center'><span class='acc acc-internal'>internal</span></td><td><b>SendPrivateMessageUnreliable</b></td><td><small>String target, Object message, Boolean encrypt, Boolean forwardAsWebhook</small></td><td class='center'><code>Boolean</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>sendPrivateMessage</b></td><td><small>String target, Object message, Boolean encrypt, Boolean reliable, Boolean forwardAsWebhook</small></td><td class='center'><code>Boolean</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>SetOnlineStatus</b></td><td><small>Int32 status, Object message, Boolean skipMessage</small></td><td class='center'><code>Boolean</code></td><td>Sets the user&#39;s status (pre-defined or custom) and an optional message.
Sets the user&#39;s status without changing your status-message.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>SetOnlineStatus</b></td><td><small>Int32 status</small></td><td class='center'><code>Boolean</code></td><td>Sets the user&#39;s status (pre-defined or custom) and an optional message.
Sets the user&#39;s status without changing your status-message.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>SetOnlineStatus</b></td><td><small>Int32 status, Object message</small></td><td class='center'><code>Boolean</code></td><td>Sets the user&#39;s status (pre-defined or custom) and an optional message.
Sets the user&#39;s status without changing your status-message.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>AddFriends</b></td><td><small>String[] friends</small></td><td class='center'><code>Boolean</code></td><td>Adds friends to a list on the Chat Server which will send you status updates for those.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>RemoveFriends</b></td><td><small>String[] friends</small></td><td class='center'><code>Boolean</code></td><td>Removes the provided entries from the list on the Chat Server and stops their status updates.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>GetPrivateChannelNameByUser</b></td><td><small>String userName</small></td><td class='center'><code>String</code></td><td>Get you the (locally used) channel name for the chat between this client and another user.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>TryGetChannel</b></td><td><small>String channelName, Boolean isPrivate, ChatChannel& channel</small></td><td class='center'><code>Boolean</code></td><td>Simplified access to either private or public channels by name.
Simplified access to all channels by name. Checks public channels first, then private ones.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>TryGetChannel</b></td><td><small>String channelName, ChatChannel& channel</small></td><td class='center'><code>Boolean</code></td><td>Simplified access to either private or public channels by name.
Simplified access to all channels by name. Checks public channels first, then private ones.</td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>TryGetPrivateChannelByUser</b></td><td><small>String userId, ChatChannel& channel</small></td><td class='center'><code>Boolean</code></td><td>Simplified access to private channels by target user.</td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>ExitGames.Client.Photon.IPhotonPeerListener.DebugReturn</b></td><td><small>DebugLevel level, String message</small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>ExitGames.Client.Photon.IPhotonPeerListener.OnEvent</b></td><td><small>EventData eventData</small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>ExitGames.Client.Photon.IPhotonPeerListener.OnOperationResponse</b></td><td><small>OperationResponse operationResponse</small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>ExitGames.Client.Photon.IPhotonPeerListener.OnStatusChanged</b></td><td><small>StatusCode statusCode</small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>TryAuthenticateOnNameServer</b></td><td><small></small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>SendChannelOperation</b></td><td><small>String[] channels, Byte operation, Int32 historyLength</small></td><td class='center'><code>Boolean</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>HandlePrivateMessageEvent</b></td><td><small>EventData eventData</small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>HandleChatMessagesEvent</b></td><td><small>EventData eventData</small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>HandleSubscribeEvent</b></td><td><small>EventData eventData</small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>HandleUnsubscribeEvent</b></td><td><small>EventData eventData</small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>HandleAuthResponse</b></td><td><small>OperationResponse operationResponse</small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>HandleStatusUpdate</b></td><td><small>EventData eventData</small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>ConnectToFrontEnd</b></td><td><small></small></td><td class='center'><code>Boolean</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>AuthenticateOnFrontEnd</b></td><td><small></small></td><td class='center'><code>Boolean</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>HandleUserUnsubscribedEvent</b></td><td><small>EventData eventData</small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-private'>private</span></td><td><b>HandleUserSubscribedEvent</b></td><td><small>EventData eventData</small></td><td class='center'><code>Void</code></td><td></td></tr><tr><td class='center'><span class='acc acc-public'>public</span></td><td><b>Subscribe</b></td><td><small>String channel, Int32 lastMsgId, Int32 messagesFromHistory, ChannelCreationOptions creationOptions</small></td><td class='center'><code>Boolean</code></td><td>Sends operation to subscribe to a list of channels by name.
Sends operation to subscribe to a list of channels by name and possibly retrieve messages we did not receive while unsubscribed.
Sends operation to subscribe client to channels, optionally fetching a number of messages from the cache.
Subscribe to a single channel and optionally sets its well-know channel properties in case the channel is created.</td></tr></tbody></table></div></div></body></html>